<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ø¨Ù„Ø© - Ù…ÙˆØ§Ù‚ÙŠØªÙŠ</title>

<style>
body {
    font-family: Tahoma, Arial;
    background: linear-gradient(#0f2027, #203a43, #2c5364);
    color: white;
    text-align: center;
    margin: 0;
    padding: 0;
}

h1 {
    margin: 20px 0;
    font-size: 28px;
    letter-spacing: 2px;
}

.compass-container {
    margin: 40px auto;
    width: 260px;
    height: 260px;
    position: relative;
}

.compass {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    border: 10px solid #2ee6c8;
    background: #fff;
    position: relative;
}

.direction {
    position: absolute;
    font-weight: bold;
    color: #000;
}

.n { top: 5px; left: 50%; transform: translateX(-50%); }
.s { bottom: 5px; left: 50%; transform: translateX(-50%); }
.e { right: 5px; top: 50%; transform: translateY(-50%); }
.w { left: 5px; top: 50%; transform: translateY(-50%); }

.needle {
    position: absolute;
    width: 6px;
    height: 110px;
    background: red;
    top: 20px;
    left: 50%;
    transform-origin: bottom center;
    transform: translateX(-50%) rotate(0deg);
    border-radius: 3px;
}

.kaaba {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 22px;
}

.info {
    margin-top: 20px;
    font-size: 18px;
}
</style>
</head>

<body>

<h1>Ù…ÙˆØ§Ù‚ÙŠØªÙŠ â€“ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ø¨Ù„Ø©</h1>

<div class="compass-container">
    <div class="compass">
        <div class="direction n">N</div>
        <div class="direction s">S</div>
        <div class="direction e">E</div>
        <div class="direction w">W</div>

        <div id="needle" class="needle"></div>
        <div class="kaaba">ğŸ•‹</div>
    </div>
</div>

<div class="info" id="info">
    Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù‡Ø§ØªÙ
</div>

<script>
// Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ù…ÙƒØ©
const kaabaLat = 21.4225;
const kaabaLng = 39.8262;

function toRad(deg) {
    return deg * Math.PI / 180;
}

function getQiblaDirection(lat, lng) {
    const dLng = toRad(kaabaLng - lng);
    const y = Math.sin(dLng);
    const x = Math.cos(toRad(lat)) * Math.tan(toRad(kaabaLat)) -
              Math.sin(toRad(lat)) * Math.cos(dLng);
    let brng = Math.atan2(y, x);
    brng = brng * 180 / Math.PI;
    return (brng + 360) % 360;
}

navigator.geolocation.getCurrentPosition(pos => {
    const lat = pos.coords.latitude;
    const lng = pos.coords.longitude;
    const qiblaAngle = getQiblaDirection(lat, lng);

    if (window.DeviceOrientationEvent) {
        window.addEventListener('deviceorientationabsolute', e => {
            let alpha = e.alpha;
            if (alpha === null) return;

            const direction = qiblaAngle - alpha;
            document.getElementById('needle').style.transform =
                `translateX(-50%) rotate(${direction}deg)`;

            document.getElementById('info').innerText =
                `Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ù‚Ø¨Ù„Ø©: ${qiblaAngle.toFixed(1)}Â°`;
        });
    } else {
        document.getElementById('info').innerText =
            'Ø¬Ù‡Ø§Ø²Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¨ÙˆØµÙ„Ø©';
    }
});
</script>

</body>
</html>
