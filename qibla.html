<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…ÙˆØ§Ù‚ÙŠØªÙŠ â€“ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ø¨Ù„Ø©</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: "Tahoma", sans-serif;
    background: linear-gradient(#0f2b2e, #123c40);
    color: white;
    text-align: center;
}

h1 {
    margin-top: 20px;
    font-size: 22px;
}

.compass-container {
    margin: 40px auto;
    width: 260px;
    height: 260px;
    position: relative;
}

.compass {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background:
      radial-gradient(circle at center, #ffffff 65%, #2dd4bf 66%);
    position: relative;
    transition: transform 0.2s linear;
}

/* Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª */
.dir {
    position: absolute;
    font-weight: bold;
    color: #000;
}

.n { top: 8px; left: 50%; transform: translateX(-50%); }
.s { bottom: 8px; left: 50%; transform: translateX(-50%); }
.e { right: 10px; top: 50%; transform: translateY(-50%); }
.w { left: 10px; top: 50%; transform: translateY(-50%); }

/* Ø¥Ø¨Ø±Ø© Ø§Ù„Ø´Ù…Ø§Ù„ */
.needle {
    position: absolute;
    width: 6px;
    height: 110px;
    background: red;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    border-radius: 3px;
}

/* Ø³Ù‡Ù… Ø§Ù„Ù‚Ø¨Ù„Ø© */
.qibla-arrow {
    position: absolute;
    width: 0;
    height: 0;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-bottom: 20px solid #16a34a;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
}

/* Ø§Ù„ÙƒØ¹Ø¨Ø© */
.kaaba {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 22px;
}

#info {
    margin-top: 20px;
    font-size: 14px;
    opacity: 0.9;
}
</style>
</head>

<body>

<h1>Ù…ÙˆØ§Ù‚ÙŠØªÙŠ â€“ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ø¨Ù„Ø©</h1>

<div class="compass-container">
    <div class="compass" id="compass">
        <div class="needle"></div>
        <div class="qibla-arrow"></div>

        <div class="dir n">N</div>
        <div class="dir s">S</div>
        <div class="dir e">E</div>
        <div class="dir w">W</div>

        <div class="kaaba">ğŸ•‹</div>
    </div>
</div>

<div id="info">Ø­Ø±Ù‘Ùƒ Ø§Ù„Ù‡Ø§ØªÙ Ù„ØªØ­Ø¯ÙŠØ¯ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ø¨Ù„Ø©</div>

<script>
const kaabaLat = 21.4225;
const kaabaLng = 39.8262;

function toRad(d) {
    return d * Math.PI / 180;
}

function getQibla(lat, lng) {
    const dLng = toRad(kaabaLng - lng);
    const y = Math.sin(dLng);
    const x =
      Math.cos(toRad(lat)) * Math.tan(toRad(kaabaLat)) -
      Math.sin(toRad(lat)) * Math.cos(dLng);
    let brng = Math.atan2(y, x);
    return (brng * 180 / Math.PI + 360) % 360;
}

const compass = document.getElementById("compass");
const info = document.getElementById("info");

navigator.geolocation.getCurrentPosition(pos => {
    const lat = pos.coords.latitude;
    const lng = pos.coords.longitude;
    const qibla = getQibla(lat, lng);

    window.addEventListener("deviceorientation", e => {
        if (e.alpha === null) {
            info.innerText = "Ø¬Ù‡Ø§Ø²Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¨ÙˆØµÙ„Ø©";
            return;
        }

        const heading = e.alpha;
        const rotation = heading - qibla;

        compass.style.transform = `rotate(${-rotation}deg)`;
        info.innerText = `Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ù‚Ø¨Ù„Ø©: ${qibla.toFixed(1)}Â°`;
    });
});
</script>

</body>
</html>
