<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Ù…ÙˆØ§Ù‚ÙŠØªÙŠ</title>

<style>
:root{
  --blue:#0b3c5d;
  --gold:#d4af37;
  --bg-light:#f5f7fb;
  --bg-dark:#0a1a2f;
  --card-light:#ffffff;
  --card-dark:#112240;
  --text-light:#000;
  --text-dark:#fff;
}

@media (prefers-color-scheme: dark){
  body{
    background:var(--bg-dark);
    color:var(--text-dark);
  }
  .card{
    background:var(--card-dark);
  }
}

@media (prefers-color-scheme: light){
  body{
    background:var(--bg-light);
    color:var(--text-light);
  }
  .card{
    background:var(--card-light);
  }
}

body{
  font-family: system-ui, sans-serif;
  margin:0;
  padding:20px;
  display:flex;
  justify-content:center;
}

.card{
  width:100%;
  max-width:380px;
  border-radius:20px;
  padding:25px;
  box-shadow:0 10px 30px rgba(0,0,0,.15);
  text-align:center;
}

h1{
  color:var(--blue);
  margin-bottom:5px;
}

#city{
  font-size:18px;
  margin-bottom:15px;
}

.time{
  padding:12px;
  margin:8px 0;
  border-radius:12px;
  background:rgba(0,0,0,.05);
  font-size:18px;
}

.next{
  background:linear-gradient(135deg,var(--gold),#f1d77a);
  color:#000;
  font-weight:bold;
}

#countdown{
  margin-top:15px;
  font-size:16px;
  color:var(--gold);
}
</style>
</head>

<body>

<div class="card">
  <h1>ğŸ•Œ Ù…ÙˆØ§Ù‚ÙŠØªÙŠ</h1>
  <div id="city">ğŸ“ Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹...</div>

  <div class="time" id="fajr"></div>
  <div class="time" id="dhuhr"></div>
  <div class="time" id="asr"></div>
  <div class="time" id="maghrib"></div>
  <div class="time" id="isha"></div>

  <div id="countdown"></div>
</div>

<script>
navigator.geolocation.getCurrentPosition(pos=>{
  const lat=pos.coords.latitude;
  const lon=pos.coords.longitude;

  fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&accept-language=ar`)
  .then(r=>r.json())
  .then(p=>{
    const c=p.address.city||p.address.town||p.address.village||"Ù…ÙˆÙ‚Ø¹Ùƒ";
    document.getElementById("city").innerText="ğŸ“ "+c;
  });

  fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=4`)
  .then(r=>r.json())
  .then(d=>{
    const t=d.data.timings;

    const prayers=[
      {id:"fajr",name:"Ø§Ù„ÙØ¬Ø±",time:t.Fajr},
      {id:"dhuhr",name:"Ø§Ù„Ø¸Ù‡Ø±",time:t.Dhuhr},
      {id:"asr",name:"Ø§Ù„Ø¹ØµØ±",time:t.Asr},
      {id:"maghrib",name:"Ø§Ù„Ù…ØºØ±Ø¨",time:t.Maghrib},
      {id:"isha",name:"Ø§Ù„Ø¹Ø´Ø§Ø¡",time:t.Isha},
    ];

    const now=new Date();
    let next=null;

    prayers.forEach(p=>{
      document.getElementById(p.id).innerText=`${p.name}: ${p.time}`;
      const [h,m]=p.time.split(":");
      const pt=new Date();
      pt.setHours(h,m,0);
      if(pt>now && !next) next={...p,date:pt};
    });

    if(!next){
      const [h,m]=prayers[0].time.split(":");
      const pt=new Date();
      pt.setDate(pt.getDate()+1);
      pt.setHours(h,m,0);
      next={...prayers[0],date:pt};
    }

    document.getElementById(next.id).classList.add("next");

    setInterval(()=>{
      const diff=next.date-new Date();
      const h=Math.floor(diff/3600000);
      const m=Math.floor(diff%3600000/60000);
      const s=Math.floor(diff%60000/1000);
      document.getElementById("countdown").innerText=
        `â³ Ù…ØªØ¨Ù‚ÙŠ Ø¹Ù„Ù‰ ${next.name}: ${h}Ø³ ${m}Ø¯ ${s}Ø«`;
    },1000);
  });
});
</script>

</body>
</html>
