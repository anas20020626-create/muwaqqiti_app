<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…ÙˆÙ‚Ù‘ØªÙŠ</title>

<style>
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: #0b2a4a;
  color: gold;
}

header {
  text-align: center;
  padding: 15px;
  font-size: 20px;
  border-bottom: 1px solid gold;
}

.card {
  background: rgba(255,215,0,0.08);
  padding: 15px;
  margin: 15px;
  border-radius: 12px;
}

.prayer {
  display: flex;
  justify-content: space-between;
  padding: 6px 0;
}

.next {
  background: rgba(255,215,0,0.2);
  border-radius: 8px;
  padding: 8px;
}

button {
  background: gold;
  color: #0b2a4a;
  border: none;
  border-radius: 8px;
  padding: 8px 12px;
  margin: 5px;
  font-weight: bold;
}
</style>
</head>

<body>

<header>ğŸ•Œ Ù…ÙˆÙ‚Ù‘ØªÙŠ</header>

<div class="card">
  <h3 id="hijri">ğŸ“…</h3>
  <div id="prayers"></div>
  <p id="countdown"></p>

  <button onclick="loadPrayers(0)">Ø§Ù„ÙŠÙˆÙ…</button>
  <button onclick="loadPrayers(1)">ØºØ¯Ù‹Ø§</button>
</div>

<script>
function loadPrayers(day) {
  navigator.geolocation.getCurrentPosition(pos => {
    fetch(`https://api.aladhan.com/v1/timings/${day}?latitude=${pos.coords.latitude}&longitude=${pos.coords.longitude}&method=4`)
      .then(r => r.json())
      .then(d => {
        const t = d.data.timings;
        document.getElementById("hijri").innerText =
          "ğŸ“… " + d.data.date.hijri.date;

        const prayers = [
          ["Ø§Ù„ÙØ¬Ø±", t.Fajr],
          ["Ø§Ù„Ø¸Ù‡Ø±", t.Dhuhr],
          ["Ø§Ù„Ø¹ØµØ±", t.Asr],
          ["Ø§Ù„Ù…ØºØ±Ø¨", t.Maghrib],
          ["Ø§Ù„Ø¹Ø´Ø§Ø¡", t.Isha]
        ];

        let html = "";
        prayers.forEach(p => {
          html += `<div class="prayer"><span>${p[0]}</span><span>${p[1]}</span></div>`;
        });

        document.getElementById("prayers").innerHTML = html;
        startCountdown(prayers);
      });
  });
}

function startCountdown(prayers) {
  clearInterval(window.timer);
  window.timer = setInterval(() => {
    const now = new Date();
    for (let p of prayers) {
      const [h, m] = p[1].split(":");
      const time = new Date();
      time.setHours(h, m, 0, 0);
      if (time > now) {
        const diff = time - now;
        const min = Math.floor(diff / 60000);
        const sec = Math.floor((diff % 60000) / 1000);
        document.getElementById("countdown").innerText =
          `â³ Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©: ${p[0]} Ø¨Ø¹Ø¯ ${min} Ø¯Ù‚ÙŠÙ‚Ø© Ùˆ ${sec} Ø«Ø§Ù†ÙŠØ©`;
        return;
      }
    }
  }, 1000);
}

loadPrayers(0);
</script>

</body>
</html>
