<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…ÙˆØ§Ù‚ÙŠØªÙŠ</title>

<style>
:root {
  --bg: linear-gradient(135deg, #f7e7b4, #fff6d8);
  --card: #ffffff;
  --primary: #0d1b3d;
  --accent: #0d1b3d;
  --text: #0d1b3d;
  --soft: #f4f1e6;
}

body.dark {
  --bg: linear-gradient(135deg, #0b1533, #0d1b3d);
  --card: #121c3a;
  --primary: #d4af37;
  --accent: #d4af37;
  --text: #f5e6b3;
  --soft: #1a2550;
}

body {
  margin: 0;
  font-family: Tahoma, Arial, sans-serif;
  background: var(--bg);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

.card {
  width: 90%;
  max-width: 380px;
  background: var(--card);
  border-radius: 20px;
  padding: 25px 20px 30px;
  text-align: center;
  box-shadow: 0 15px 35px rgba(0,0,0,0.15);
}

.title {
  font-size: 30px;
  font-weight: bold;
  color: var(--primary);
}

.city {
  font-size: 18px;
  color: var(--text);
  margin: 10px 0 6px;
}

.notice {
  font-size: 13px;
  color: #888;
  margin-bottom: 10px;
}

.time {
  background: var(--soft);
  margin: 8px 0;
  padding: 12px;
  border-radius: 14px;
  font-size: 18px;
  color: var(--text);
}

.next {
  border: 2px solid var(--accent);
  background: linear-gradient(135deg, rgba(212,175,55,0.25), var(--soft));
  font-weight: bold;
}

.retry {
  display: none;
  margin-top: 12px;
  padding: 10px;
  font-size: 14px;
  border-radius: 12px;
  border: 1px solid var(--accent);
  background: transparent;
  color: var(--accent);
  cursor: pointer;
}

.toggle {
  margin-top: 12px;
  font-size: 14px;
  color: var(--primary);
  cursor: pointer;
}
</style>
</head>

<body class="dark">

<div class="card">
  <div class="title">ğŸ•Œ Ù…ÙˆØ§Ù‚ÙŠØªÙŠ</div>
  <div id="city" class="city">ğŸ“ Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒ...</div>
  <div id="notice" class="notice">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹</div>

  <div id="fajr" class="time">Ø§Ù„ÙØ¬Ø±: --:--</div>
  <div id="dhuhr" class="time">Ø§Ù„Ø¸Ù‡Ø±: --:--</div>
  <div id="asr" class="time">Ø§Ù„Ø¹ØµØ±: --:--</div>
  <div id="maghrib" class="time">Ø§Ù„Ù…ØºØ±Ø¨: --:--</div>
  <div id="isha" class="time">Ø§Ù„Ø¹Ø´Ø§Ø¡: --:--</div>

  <button id="retryBtn" class="retry" onclick="loadLocation()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
  <div class="toggle" onclick="toggleMode()">ğŸ” ØªØºÙŠÙŠØ± Ø§Ù„ÙˆØ¶Ø¹</div>
</div>

<script>
function toggleMode() {
  document.body.classList.toggle("dark");
}

function loadLocation() {
  const retry = document.getElementById("retryBtn");
  const notice = document.getElementById("notice");

  if (!navigator.geolocation) {
    city.innerText = "ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…";
    retry.style.display = "block";
    return;
  }

  navigator.geolocation.getCurrentPosition(pos => {
    retry.style.display = "none";
    notice.style.display = "none";

    const lat = pos.coords.latitude;
    const lon = pos.coords.longitude;

    fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&accept-language=ar`)
      .then(r => r.json())
      .then(p => {
        city.innerText = "ğŸ“ " + (
          p.address.city ||
          p.address.town ||
          p.address.village ||
          p.address.hamlet ||
          "Ù…ÙˆÙ‚Ø¹Ùƒ"
        );
      });

    fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=4`)
      .then(r => r.json())
      .then(d => {
        const t = d.data.timings;
        const prayers = [
          {id:"fajr",name:"Ø§Ù„ÙØ¬Ø±",time:t.Fajr},
          {id:"dhuhr",name:"Ø§Ù„Ø¸Ù‡Ø±",time:t.Dhuhr},
          {id:"asr",name:"Ø§Ù„Ø¹ØµØ±",time:t.Asr},
          {id:"maghrib",name:"Ø§Ù„Ù…ØºØ±Ø¨",time:t.Maghrib},
          {id:"isha",name:"Ø§Ù„Ø¹Ø´Ø§Ø¡",time:t.Isha}
        ];

        prayers.forEach(p=>{
          const el=document.getElementById(p.id);
          el.classList.remove("next");
          el.innerText=`${p.name}: ${p.time}`;
        });

        const now=new Date();
        let next=null;
        for(let p of prayers){
          const [h,m]=p.time.split(":");
          const pt=new Date(); pt.setHours(h,m,0);
          if(pt>now){ next=p; break;}
        }
        if(!next) next=prayers[0];
        document.getElementById(next.id).classList.add("next");
      });

  }, ()=>{
    city.innerText = "ğŸ“ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ù…ÙˆÙ‚Ø¹";
    retry.style.display = "block";
  });
}

window.onload = loadLocation;
</script>

</body>
</html>
